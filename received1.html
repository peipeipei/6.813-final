<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="photopage.css">
    <link rel="stylesheet" type="text/css" href="critique.css">
    <link rel="stylesheet" type="text/css" href="header.css">
    <link rel="stylesheet" type="text/css" href="inbox.css"> 
    <link href='http://fonts.googleapis.com/css?family=Redressed' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="circleDrawing.css" />
    
    <title>Aperture - Received Critique</title>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    
    <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Quattrocento+Sans' rel='stylesheet' type='text/css'>
    
    <script type="text/javascript" src="circle_drawing.js"></script>
    <script type="text/javascript">
		var drawable = false;
		var this_id = 0;
		var editing = false;
		
		$(document).ready(function(){
			// Prevent Backspace from going back since we use it for deleting
			$(document).keydown(function (e) {
				if (e.keyCode == 8 && !$(e.target).is("input, textarea")) {
					e.preventDefault();
				}
			});
			
			$("#loading").modal("show");
			
			$("#subject").text("China Mountain");
			$("#photo").attr("src", "photos/chinamountain.jpg");
			$("#from").text("Alice Jones");
			$("#photo-title").text("China Mountain");
			$("#comments_list").text("Good job!");
			
			// FIRST COMMENT
			
			var div1 = document.createElement("div");
			div1.id = "div_1";
			div1.className = "circle-group";
			$("#photo-wrapper").append(div1);
		
			setCircleInactive(saveCircle(100, 76, 40, null, "div_1"));
			setCircleInactive(saveCircle(496, 243, 56, null, "div_1"));
			setCircleInactive(saveCircle(212, 104, 100, null, "div_1"));
			
			$("#comments").append(getComment("comment_1", "Cool!"));
			
			// SECOND COMMENT
			
			var div2 = document.createElement("div");
			div2.id = "div_2";
			div2.className = "circle-group";
			$("#photo-wrapper").append(div2);
		
			setCircleInactive(saveCircle(75, 252, 71, null, "div_2"));
			setCircleInactive(saveCircle(444, 374, 101, null, "div_2"));
			setCircleInactive(saveCircle(476, 30, 167, null, "div_2"));
			
			$("#comments").append(getComment("comment_2", "Nice!"));
			
			// THIRD COMMENT
			
			var div3 = document.createElement("div");
			div3.id = "div_3";
			div3.className = "circle-group";
			$("#photo-wrapper").append(div3);
		
			setCircleInactive(saveCircle(147, 298, 162, null, "div_3"));
			setCircleInactive(saveCircle(30, 134, 57, null, "div_3"));
			setCircleInactive(saveCircle(386, 398, 222, null, "div_3"));
			
			$("#comments").append(getComment("comment_3", "Awesome!"));
			
			$("#loading").modal("hide");
		
			// generate html for a comment
			function getComment(commentID, msg){
				var comment = document.createElement("div");
				$(comment).addClass("comment");
				comment.id = commentID;
				$(comment).append(msg);
				
				return $(comment);
			}
			
			// activate comment that is clicked on or hovered and deactivate others
			function activate2(id){
				$(".comment").each(function(i, obj){
					var comment_id = obj.id.substring(8);
					
					// activate comment and circles
					if (id === comment_id){
						$("#comment_" + id).addClass("active");
						
						$("#div_" + id).children().each(function (){
							$(this).removeClass("inactive");
							$(this).addClass("circle");
						})
						
						$("#div_" + id).css("z-index", "100");
					}
					//deactivate all other comments
					else {
						$("#comment_" + comment_id).removeClass("active");
						
						$("#div_" + comment_id).children().each(function (){
							setCircleInactive($(this));
						});
						
						$("#div_" + comment_id).css("z-index", "50");
					}
				});
			}
			
			$(document).on("click", ".comment", function(){
				var id = this.id.substring(8)
				activate2(id);
			});
		});
    </script>
</head>
<body>
    <div class="modal fade" id="loading" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body">
                	<h4 class="modal-title">Loading...</h4>
                	<div class="progress" style="margin-top: 20px;">
                    	<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <div class="header">

            <div class="top">
                <div class="col-xs-4" id="left-header">
                    
                </div>

                <div class="col-xs-4" id="mid-header">
                    <p id="logo">aperture</p>
                </div>

                <div class="col-xs-4" id="right-header">

                    <div class="dropdown gallery-dropdown">
                        <button class="btn btn-default dropdown-togglen gallery-drop-button" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                            Galleries
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">
                            <li role="presentation"><a role="menuitem" tabindex="-1" href="gallery1.html">Nature</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">N/A</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">N/A</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">N/A</a></li>
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

<div id = "container">
    <div id = "message-header">
        <form class="form-horizontal">
        <div class="form-group">
            <label class="col-sm-2 ">Subject: </label>
            <div class="col-sm-10">
                <span id = "subject"></span>
            </div>
        </div>
  
        <div class="form-group">
            <label class="col-sm-2 ">From: </label>
            <div class="col-sm-10">
                <span id = "from"></span>
            </div>
        </div>
        </form>
    </div>

    <div id = "photo-wrap">
        <h3>Title: <span id="photo-title"></span></h3>
        <div id = "photo-wrapper"><img id = "photo" src="" style="padding: 0"/></div>
        <h3>Overall Comments:</h3>
        <div id="comments_list"></div>
    </div>

    <div id = "comments">
       <h3> Focal Points</h3>
    </div>
</div>
</div>


</body>
</html>